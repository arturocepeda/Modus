<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.4"/>
<title>Modus: Modus v0.53 - C++ Music Library</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Modus
   &#160;<span id="projectnumber">v0.53</span>
   </div>
   <div id="projectbrief">C++ Music Library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.4 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li class="current"><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('index.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Modus v0.53 - C++ Music Library </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><div align="center"><div class="image">
<img src="modus.jpg" />
</div>
</div><h1><a class="anchor" id="contents"></a>
Contents</h1>
<p>General:<br/>
 <a class="el" href="index.html#overview">Overview</a> <br/>
 <a class="el" href="index.html#license">License</a> <br/>
 <a class="el" href="index.html#components">Components</a> <br/>
 <a class="el" href="index.html#nomenclature">Nomenclature</a> <br/>
</p>
<p>Concepts:<br/>
 <a class="el" href="index.html#musicalnotes">Musical notes</a> <br/>
 <a class="el" href="index.html#time">Time</a> <br/>
 <a class="el" href="index.html#mainobjects">Main objects</a> <br/>
 <a class="el" href="index.html#soundgenerators">Sound generators</a> <br/>
 <a class="el" href="index.html#samplesets">Sample-sets</a> <br/>
 <a class="el" href="index.html#samplepacks">Sample-packs</a> <br/>
</p>
<p>Project Settings:<br/>
 <a class="el" href="index.html#projectsettings">Project Settings</a> <br/>
</p>
<p>Working with Modus:<br/>
 <a class="el" href="index.html#notemaps">Note maps</a> <br/>
 <a class="el" href="index.html#scripts">Scripts</a> <br/>
 <a class="el" href="index.html#pitchvalues">Pitch values</a> <br/>
 <a class="el" href="index.html#callbacks">Callbacks</a> <br/>
 <a class="el" href="index.html#representing">Representing musical performances</a> <br/>
 <a class="el" href="index.html#tipsandtricks">Tips and tricks</a> <br/>
<br/>
</p>
<h1><a class="anchor" id="overview"></a>
Overview</h1>
<p>Modus is an open source, cross-platform C++ library which allows you to handle music from code. This means that you can:</p>
<ul>
<li>
Manage interactive and adaptive music </li>
<li>
Use some kind of algorithm to improvise </li>
<li>
Represent visually (simulate) musical performances </li>
<li>
Select in real time the instruments that are going to play a previously written song </li>
<li>
Let the user take part on the performance through any type of interface, by playing an instrument, changing the tempo, choosing the instruments, designing the structure of the song, etc. </li>
<li>
Define song structures with metric modulations, accelerandos and ritardandos </li>
<li>
Write your own scores, which can then be assigned to instruments to be played </li>
<li>
Play along with a pre-recorded song or represent the performance </li>
<li>
Everything else that comes into your head </li>
</ul>
<p>Modus works with instrument objects, which represent the instruments in real life, in addition to other more abstract concepts such as samplers, voices, noise generators or whatever. You need to attach each instrument object to a sound generator to make it sound, and then you can play notes by just calling a method. <br/>
</p>
<p>Besides the possibility of calling the instrument object to play each note, you can also use a powerful tool: the score object. This object tells an instrument what to play, and has the advantage that can be programmed dynamically. In order to make this process easier, Modus provides you with a script syntax, so you can just write a script and load it into the score, either from a plain text file or through a string inside the code. <br/>
</p>
<p>But if you don't want to bother to write scripts for entire songs -what might be a lot of work-, just use the <em>MIDI-to-MScore</em> tool, which generate scripts automatically from MIDI files, so you have the possibility to utilize your favorite MIDI editor or score editing software to enter the music and then create scripts for Modus. <br/>
</p>
<p>Modus provides objects to work with harmony and scales too, including lists -in the same way of the score object- and static classes which allow you to easily build note maps with scales, chords and voicings. <br/>
</p>
<p>Along with this release of Modus a MIDI sound generator, based on the RtMidi library, in addition to three different audio sound generators based on the following engines have been included:</p>
<ul>
<li>
FMOD Ex </li>
<li>
OpenAL </li>
<li>
irrKlang </li>
</ul>
<p>Also, you have at your disposal some instruments to be used with these sound generators, including complete sample-packs, so you can start to generate music from the first moment! <br/>
<br/>
</p>
<div align="center"> <em>NOTE: <b>FMOD Ex</b> and <b>irrKlang</b> are not free products. They can only be used free <br/>
 of charge for applications that are not going to be commercially released. So if you are <br/>
 going to utilize either FMOD or irrKlang with your applications, please keep in mind that <br/>
 they cannot be commercial products unless you buy the corresponding license. Visit <br/>
 FMOD's or irrKlang's web site in order to get further information about this.</em> <br/>
<br/>
 </div><h1><a class="anchor" id="license"></a>
License</h1>
<p>Modus has been released under the MIT license. That means that you can freely use Modus both for commercial and non-commercial applications and you are also allowed to modify and/or distribute it (in that case, please read "license.txt"). <br/>
<br/>
</p>
<h1><a class="anchor" id="components"></a>
Components</h1>
<p>Modus is made up of the following componentes:</p>
<ul>
<li>
<p class="startli">Base library. Every application that makes use of Modus must include this library. The base library is written in standard C++, so it's platform independent.<br/>
</p>
<p class="endli"></p>
</li>
<li>
<p class="startli">Sound generators. Objects that depend on external audio/MIDI engines and are capable of generating sound through the sound card. A sound generator may be cross-platform as long as the base engine is also cross-platform.<br/>
</p>
<p class="endli"></p>
</li>
<li>
Extensions. Modules which utilize AI processes and are designed to interact with the base library's objects. Along with this release, an improviser object and a humanizer static class are provided. They are intented to be cross-platform too. </li>
</ul>
<p><br/>
</p>
<h1><a class="anchor" id="nomenclature"></a>
Nomenclature</h1>
<ul>
<li>
Simple data or vector type definitions: <b>MT...</b> </li>
<li>
Data structures: <b>MS...</b> </li>
<li>
Classes: <b>MC...</b> </li>
</ul>
<p><br/>
</p>
<h1><a class="anchor" id="musicalnotes"></a>
Musical notes</h1>
<p>In Modus you will always work with musical notes. Each note is defined by 8 values, some of which are not required. Thinking on the users who are used to the MIDI protocol, Modus was intended to work with the same range of values to define musical notes:</p>
<ul>
<li>
<p class="startli">Pitch. Defined by the MIDI pitch value, where the corresponding value for the middle C (C4) is 60. Pitch 0 means "rest".</p>
<p class="endli"></p>
</li>
<li>
Intensity. Similar to the velocity in the MIDI's world (1-127). Intensity 0 means "rest" too. </li>
</ul>
<p><br/>
 The rest of the values that define a musical note in Modus are:</p>
<ul>
<li>
<p class="startli">Duration. Given in ticks (see "Time"). Duration 0 means that the note must not be released until the sample's end is reached or a rest comes.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli">Channel. For the instruments to be polifonic (that is to say, to be able to play several notes at the same time), you have to work with channels. If an instrument has N channels, that means that it is capable to play up to N independent notes at the same time. For example, a guitar would have 6 channels since it has 6 independent strings. The channel is defined through a value between 0 and N-1.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli">Mode. Sometimes you may want to use an instrument in some different ways instead of creating two or more instruments (for example, a trumpet can play with or without mute, or a drum set can be played either with sticks or with brushes). With this purposal you have the mode field at your disposal, so that you would only have to specify the mode for each note to indicate how it should be played.</p>
<p class="endli"></p>
</li>
<li>
Metadata. Into the data structure that represents musical notes, three metadata fields have been added for you to use them in the way you want. These additional fields will be normally used to represent visually musical performances, by being filled with technical details such as finger on piano, string and fret on guitar, state of the keys/valves on wind instruments, etc. </li>
</ul>
<p><br/>
</p>
<h1><a class="anchor" id="time"></a>
Time</h1>
<p>The time positions in Modus are defined by 3 values: measure, beat and tick. The "tick" is the smallest unit of time in Modus. The number of beats per measure will be defined by the user, whereas each beat always contains 24 ticks. Thus, regardless of the musical time unit you want to use you will have great versatility to represent what you want. In the following tables you can see the relationship between the rhythmic figures and the number of ticks: <br/>
</p>
<div align="center"> <em>Rhythmic unit: quarter note</em> </p>
<table  border="1" cellpadding="10">
<tr>
<th>Figure </th><th>Number of ticks  </th></tr>
<tr>
<td><div class="image">
<img src="note_w.jpg" />
</div>
 </td><td>96  </td></tr>
<tr>
<td><div class="image">
<img src="note_hd.jpg" />
</div>
 </td><td>72  </td></tr>
<tr>
<td><div class="image">
<img src="note_h.jpg" />
</div>
 </td><td>48  </td></tr>
<tr>
<td><div class="image">
<img src="note_4d.jpg" />
</div>
 </td><td>36  </td></tr>
<tr>
<td><div class="image">
<img src="note_4.jpg" />
</div>
 </td><td>24  </td></tr>
<tr>
<td><div class="image">
<img src="note_8d.jpg" />
</div>
 </td><td>18  </td></tr>
<tr>
<td><div class="image">
<img src="note_4tr.jpg" />
</div>
 </td><td>16  </td></tr>
<tr>
<td><div class="image">
<img src="note_8.jpg" />
</div>
 </td><td>12  </td></tr>
<tr>
<td><div class="image">
<img src="note_8tr.jpg" />
</div>
 </td><td>8  </td></tr>
<tr>
<td><div class="image">
<img src="note_16.jpg" />
</div>
 </td><td>6  </td></tr>
<tr>
<td><div class="image">
<img src="note_32.jpg" />
</div>
 </td><td>3  </td></tr>
</table>
</div><div align="center"><br/>
<br/>
</div><div align="center"><em>Rhythmic unit: dotted quarter note</em> </p>
<table  border="1" cellpadding="10">
<tr>
<th>Figure </th><th>Number of ticks  </th></tr>
<tr>
<td><div class="image">
<img src="note_hd.jpg" />
</div>
 </td><td>48  </td></tr>
<tr>
<td><div class="image">
<img src="note_4d.jpg" />
</div>
 </td><td>24  </td></tr>
<tr>
<td><div class="image">
<img src="note_4.jpg" />
</div>
 </td><td>16  </td></tr>
<tr>
<td><div class="image">
<img src="note_8d.jpg" />
</div>
 </td><td>12  </td></tr>
<tr>
<td><div class="image">
<img src="note_8.jpg" />
</div>
 </td><td>8  </td></tr>
<tr>
<td><div class="image">
<img src="note_16.jpg" />
</div>
 </td><td>4  </td></tr>
<tr>
<td><div class="image">
<img src="note_32.jpg" />
</div>
 </td><td>2  </td></tr>
</table>
</div><p><br/>
<br/>
</p>
<h1><a class="anchor" id="mainobjects"></a>
Main objects</h1>
<p><b><a class="el" href="class_m_c_instrument.html" title="Represents an entity that is able to play notes. ">MCInstrument</a></b><br/>
</p>
<p>The instrument object represents something that can play music, like, for example, a real instrument. It provides you with the <em>playNote()</em> and <em>release()</em> methods, so it's very simple and intuitive to use. <br/>
</p>
<p>To create an instrument object, you need to specify a number of channels. The number of channels an instrument has determines how many independent notes the instrument can play at the same time. For example, a string instrument would have so many channels as strings, whereas a wind instrument would have only one channel (unless you want it to be able to produce multiphonics or something like that). <br/>
</p>
<p>Besides just playing and releasing notes, other interesting things you can do with an instrument are bend notes, use a "damper pedal" (sustain the notes), define a transposition, set an intensity variation or define callback functions to be called when specific events occur (see "Callbacks" section). <br/>
<br/>
</p>
<p><b><a class="el" href="class_m_c_timer.html" title="Timer object that provides a periodic signal to make it possible to play music according to a particu...">MCTimer</a></b><br/>
</p>
<p>This object is the heart of all applications which utilize Modus. It calls a callback function each time a new tick comes, so that you will be able to update the instruments and do all the stuff you need from there. For the timer to work, you need to update it from inside a loop. You can either make this call from an independent thread or include it into the main loop (in case your application has one):</p>
<div class="fragment"><div class="line"><span class="keywordflow">while</span>(!bAppEnd)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// check input</span></div>
<div class="line">    ...</div>
<div class="line"></div>
<div class="line">    <span class="comment">// update data</span></div>
<div class="line">    ...</div>
<div class="line">        </div>
<div class="line">    <span class="comment">// update music timer</span></div>
<div class="line">    mTimer-&gt;update();</div>
<div class="line"></div>
<div class="line">    <span class="comment">// render</span></div>
<div class="line">    ...</div>
<div class="line">}</div>
</div><!-- fragment --><div class="fragment"><div class="line"><span class="keywordflow">while</span>(!bThreadEnd)</div>
<div class="line">{</div>
<div class="line">    mTimer-&gt;update();</div>
<div class="line">}</div>
</div><!-- fragment --><p>The <em>update()</em> method returns a boolean value that indicates whether the update took place or not. <br/>
<br/>
 The timer object can be used in two different ways:</p>
<ul>
<li>
<p class="startli">Fixed values. It has a tempo and a number of beats per measure, and these values are fixed. You can change them as many times as you want manually, though.</p>
<p class="endli"></p>
</li>
<li>
Song structure. This option is more powerful and is the best way to manage situations in which you want to include metric modulations and/or accelerandos or ritardandos. To specify a song structure there is the <a class="el" href="class_m_c_song_structure.html" title="Definition of the structure of a song, which consists of a list of sections. Tempo changes...">MCSongStructure</a> object, which is attached to the timer through the <em>setSongStructure()</em> method. </li>
</ul>
<p><br/>
 <b><a class="el" href="class_m_c_score.html" title="Represents a score, which consist of a list of notes placed on time positions. ">MCScore</a></b><br/>
</p>
<p>It's basically an ordered list of notes to play. The good part of the score object is that its data can be modified in real time, so you have the possibility to use it with different purposes:</p>
<ul>
<li>
<p class="startli">As a traditional score: write the score, and then an instrument will perform the music that has been written on it.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli">As a kind of buffer: write notes on the score directly from software and play them after (for example, a music recorder).</p>
<p class="endli"></p>
</li>
<li>
Mixing both ideas: add, modify or remove notes from software on a previously written score. </li>
</ul>
<p><br/>
</p>
<h1><a class="anchor" id="soundgenerators"></a>
Sound generators</h1>
<p>The sound generator is the way through which the instrument objects produce sound in Modus. They are based on external libraries and can generate sound either by synthesis (MIDI) or by playing digital audio samples (audio). When you want an instrument object to sound, you only have to create an instance of a sound generator, configure it and attach it to the instrument object. <br/>
</p>
<p>First of all, you should read some notes regarding the audio sound generators:</p>
<ul>
<li>
<p class="startli">Never delete a <a class="el" href="class_m_c_sound_gen_audio.html" title="Abstract class intended to provide an interface to create sound generators that work with digital aud...">MCSoundGenAudio</a> object after having released the corresponding audio system. That would cause an error due to invalid memory access.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli">You don't need to unload the samples that you previously loaded by calling <em>unloadSamples()</em>, unless you want to replace them with others. That is because the destructor of the class does it already when you delete the object.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli">When using FMOD-based sound generators, make sure that you are calling periodically the FMOD system's <em>update()</em> method, since through this method FMOD handles the virtualization of the voices and allows you to use as many channels as you want with your instruments. In addition, you will need to update FMOD if you want your instruments to change their positions, either on stereo or multichannel speaker systems.</p>
<p class="endli"></p>
</li>
<li>
When using FMOD-based sound generators, keep in mind that you can specify the DSP buffer size at the moment of the initialization through the FMOD system's <em>setDSPBufferSize()</em> method. The smaller this value, the lower the latency, what can be very important for applications in which one or more users have to play music in real time. So in these cases, try to use a small value as DSP buffer size, but be aware that a too small value would cause an unwanted distortion. </li>
</ul>
<p>The sound generators must be updated with each new tick, but if the sound generator is attached to an instrument, you will only need to update the instrument, since the instrument updates its sound generator automatically. <br/>
<br/>
</p>
<h1><a class="anchor" id="samplesets"></a>
Sample-sets</h1>
<p>All the audio-based sound generators work with audio samples. Each time a note is requested to be played, the sound generator finds the appropriate sample to make it sound. For the sound generator to know which sample must be played for each note, you need to define a list of sample-sets. In order to define a sample-set, the following parameters must be specified:</p>
<ul>
<li>
<p class="startli">ID: each sample-set in the sound generator will have its own ID number.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli">Path: path in which the sample files are located, with the '/' or '\' symbol (depending on the platform) at the end.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli">Format: extension of the sound files, without dot at the beginning.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli">Mode: the samples contained in the sample-set will be assigned to an unique mode.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli">Intensity range: the samples contained in the sample-set will be selected only when the note's intensity is inside this range.</p>
<p class="endli"></p>
</li>
<li>
Pitch range: these two values define how many samples are in the sample-set. </li>
</ul>
<p>Once you have defined all these values for the sample-set (<a class="el" href="struct_m_s_sample_set.html" title="Set of samples for a sound generator. ">MSSampleSet</a> struct), then you can add it to the sound generator's sample-set list through the <em>addSampleSet()</em> method. When all the sample-sets you want to use for the sound generator have been added, you just have to call the <em>loadSamples()</em> method to load the sample files into memory. <br/>
</p>
<p>Previously, of course you need to have all the sample files ready to be loaded. For each sample-set:</p>
<ol>
<li>
<p class="startli">Select the audio files you want to load. Make sure that all of them have the same format and the same extension.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli">Place them together into the same folder (that will be the folder you have to specify in the field "path").</p>
<p class="endli"></p>
</li>
<li>
Name each sample file like this: &lt;sample-set ID (two digits) - underscore - pitch (three digits) - dot - format&gt; <br/>
 (Example: 00_060.wav, 00_061.wav, 00_062.wav...) </li>
</ol>
<p><br/>
</p>
<h1><a class="anchor" id="samplepacks"></a>
Sample-packs</h1>
<p>The sample-packs are a very comfortable way to manage sample-sets. A sample-pack is an unique file which contains both information about all the sample-sets included in it and all the audio files defined by these sample-sets. The sample-pack files have the extension ".msp" ("Modus Sample Pack"). <br/>
</p>
<p>In order to create your own sample-packs, you have to prepare the audio files in the same way it was explained in the previous section, and then you can use the <em>msamplepack</em> tool (included with Modus). <br/>
</p>
<p>To load a sample-pack file from a sound generator object, you only have to call the <em>loadSamplePack()</em> method. <br/>
<br/>
<br/>
</p>
<h1><a class="anchor" id="projectsettings"></a>
Project Settings</h1>
<p>Whatever are the development environment, compiler or linker you are working with, you will need to follow these steps to set up a project that utilizes Modus:</p>
<ol>
<li>
<p class="startli">Add include directories. Modus/include and Modus/soundgen are required in all cases, and if you want to use any extension you will also need to add Modus/extensions. </p>
<p class="endli"></p>
</li>
<li>
<p class="startli">Add Modus library. You will find the appropriate library file in the Modus/lib/[platform] directory. </p>
<p class="endli"></p>
</li>
<li>
<p class="startli">Add sound generator's source files. This means that you have to add the cpp files in the Modus/soundgen/[chosen_soundgen] directory. <br/>
<br/>
 <b>Note for iOS:</b> use "mxsoundgenopenal.mm" instead of "mxsoundgenopenal.cpp". </p>
<p class="endli"></p>
</li>
<li>
<p class="startli">Add sound generator's external dependencies. All the files you may need are inside the Modus/soundgen/externals/[library] directory. If you are using OpenAL, don't forget to include also the Ogg Vorbis libraries in case you want to load audio samples in this format (the sample-packs that come along with the examples are made up of Ogg Vorbis audio files), as OpenAL does not support compressed audio decoding in itself. <br/>
<br/>
 <b>Note for iOS:</b> OpenAL is included as a framework, so you will just need to add OpenAL.framework to the project to use the OpenAL-based sound generator. On the other hand, keep in mind that you can work with any compressed audio format supported by the AudioToolBox framework (such as AAC or IMA4). </p>
<p class="endli"></p>
</li>
</ol>
<p><br/>
</p>
<h1><a class="anchor" id="notemaps"></a>
Note maps</h1>
<p>One interesting feature in Modus is the MTNoteMap. It just consist of a list of notes (pitches), but may be very useful for some particular tasks, though.</p>
<ul>
<li>
<p class="startli">The <a class="el" href="class_m_c_note_maps.html" title="Static class with some methods to work with note maps (MTNoteMap) ">MCNoteMaps</a> static class offers several methods to work with note maps</p>
<p class="endli"></p>
</li>
<li>
<p class="startli"><a class="el" href="class_m_c_chords.html" title="Static class to work with chords. ">MCChords</a> works with note maps, considered as chord patterns</p>
<p class="endli"></p>
</li>
<li>
<a class="el" href="class_m_c_scales.html" title="Static class to work with scales. ">MCScales</a> works with note maps, considered as scale patterns </li>
</ul>
<p>Note maps can be used to restrict the set of notes which should be allowed to be played in a particular moment. For example, to improvise you might want to let your algorithm generate notes that belong to a specific scale inside a specific range. <br/>
<br/>
</p>
<h1><a class="anchor" id="scripts"></a>
Scripts</h1>
<p>They can be written either in strings or text files and then loaded from some of the objects, through the <em>loadScriptFromString()</em> and the <em>loadScriptFromFile()</em> methods, respectively. In addition, you have the possibility of creating binary files from previously written text files using the included <b>mscript2bin</b> tool, and load them with the <em>loadScriptFromBinaryData()</em> and the <em>loadScriptFromBinaryFile()</em> methods. Scripts in binary format are smaller and faster to load than scripts in text format, but they cannot be modified once generated.<br/>
<br/>
</p>
<p><b><a class="el" href="class_m_c_score.html" title="Represents a score, which consist of a list of notes placed on time positions. ">MCScore</a></b><br/>
</p>
<p>Since a score object is basically a list of notes attached to time positions, there are commands to specify note values and time values. The following table includes the commands which are referred to the time:</p>
<div align="center"> <table  border="1" cellpadding="10">
<tr>
<th>Command </th><th>Description </th><th>Value range  </th></tr>
<tr>
<td>bpm:&lt;val&gt; </td><td>Beats per measure </td><td>1-...  </td></tr>
<tr>
<td>[m:&lt;val&gt;] </td><td>Time position: measure </td><td>0-...  </td></tr>
<tr>
<td>[b:&lt;val&gt;] </td><td>Time position: beat </td><td>1-...  </td></tr>
<tr>
<td>[t:&lt;val&gt;] </td><td>Time position: tick </td><td>0-23  </td></tr>
</table>
</div><p><br/>
 Through these commands the time position's cursor will be set at the specified position, so the next notes you write will have assigned that time position. The commands referred to time positions must always be inside square brackets and can be combined as follows:</p>
<div class="fragment"><div class="line">[m:1 b:3 t:12]  ; current time position -&gt; Measure 1, Beat 3, Tick 12</div>
<div class="line">[m:3]           ; current time position -&gt; Measure 3, Beat 1, Tick 0</div>
<div class="line">[m:4 b:2]       ; current time position -&gt; Measure 4, Beat 2, Tick 0</div>
</div><!-- fragment --><p><br/>
To add notes to the score, you can use these commands:</p>
<div align="center"> <table  border="1" cellpadding="10">
<tr>
<th>Command </th><th>Description </th><th>Value range  </th></tr>
<tr>
<td>p:&lt;val&gt; </td><td>Note pitch </td><td>0-255  </td></tr>
<tr>
<td>ch:&lt;val&gt; </td><td>Channel </td><td>0-255  </td></tr>
<tr>
<td>d:&lt;val&gt; </td><td>Note duration </td><td>0-255  </td></tr>
<tr>
<td>i:&lt;val&gt; </td><td>Note intensity </td><td>0-127  </td></tr>
<tr>
<td>mode:&lt;val&gt; </td><td>Mode </td><td>0-255  </td></tr>
<tr>
<td>mda:&lt;val&gt; </td><td>Metadata A </td><td>0-255  </td></tr>
<tr>
<td>mdb:&lt;val&gt; </td><td>Metadata B </td><td>0-255  </td></tr>
<tr>
<td>mdc:&lt;val&gt; </td><td>Metadata C </td><td>0-255  </td></tr>
<tr>
<td>+ </td><td>Add duration to the current time position </td><td>&mdash;  </td></tr>
<tr>
<td>&gt; </td><td>Insert note into score </td><td>&mdash;  </td></tr>
</table>
</div><p><br/>
 It's important to keep in mind that you don't need to set all these values each time you write a note on the script, but they stay until you change them again. This means that if you write "i:96" and then several notes, all these notes will be interpreted with 96 as their intensity. There is one only exception: the metadata values, which are automatically set to 0 every time there is an insert command (&gt;) on the script.</p>
<p>The add duration command (+) may be useful if you want to write a legato-style line, so that the current note's release moment is the same than the moment in which the next one must start to sound. If you place the add duration command (+) and the insert command (&gt;) on the same line, the duration of the current note will be added to the current time position automatically, so you won't need to specify the time position in which the next note comes:</p>
<div class="fragment"><div class="line">[m:5]</div>
<div class="line">p:60 i:64 d:12 &gt; +    ; added at time position (5, 1, 0)</div>
<div class="line">p:62 i:64 d:6 &gt; +     ; added at time position (5, 1, 12)</div>
<div class="line">p:64 i:64 d:6 &gt; +     ; added at time position (5, 1, 18)</div>
<div class="line">p:60 i:64 d:24 &gt;      ; added at time position (5, 2, 0)</div>
</div><!-- fragment --><p> <br/>
</p>
<p>Examples:</p>
<div class="image">
<img src="score1.jpg" />
</div>
 <div class="fragment"><div class="line">bpm:4 mode:0 ch:0 i:64</div>
<div class="line"></div>
<div class="line">p:72 d:48 &gt; +</div>
<div class="line">p:76 d:24 &gt; +</div>
<div class="line">p:79 d:24 &gt; +</div>
<div class="line"></div>
<div class="line">p:71 d:36 &gt; +</div>
<div class="line">p:72 d:6 &gt; +</div>
<div class="line">p:74 d:6 &gt; +</div>
<div class="line">p:72 d:24 &gt; +</div>
<div class="line">p:0 d:24 &gt; +</div>
</div><!-- fragment --><p> <br/>
<br/>
</p>
<div class="image">
<img src="score2.jpg" />
</div>
 <div class="fragment"><div class="line">bpm:3 mode:0 ch:0 i:64</div>
<div class="line"></div>
<div class="line">[m:1 b:3]</div>
<div class="line">p:63 d:21 &gt;</div>
<div class="line">[t:21]</div>
<div class="line">p:62 d:3 &gt;</div>
<div class="line"></div>
<div class="line">[m:2]</div>
<div class="line">p:62 d:24 &gt;</div>
<div class="line">[b:3]</div>
<div class="line">p:62 d:21 &gt;</div>
<div class="line">[t:21]</div>
<div class="line">p:63 d:3 &gt;</div>
<div class="line"></div>
<div class="line">[m:3]</div>
<div class="line">p:63 d:24 &gt;</div>
</div><!-- fragment --><p> <br/>
<br/>
</p>
<div class="image">
<img src="score3.jpg" />
</div>
 <div class="fragment"><div class="line">bpm:4 mode:0 i:64 d:48</div>
<div class="line"></div>
<div class="line">p:67 ch:0 &gt;</div>
<div class="line">p:72 ch:1 &gt;</div>
<div class="line">p:76 ch:2 &gt; +</div>
<div class="line"></div>
<div class="line">p:69 ch:0 &gt;</div>
<div class="line">p:72 ch:1 &gt;</div>
<div class="line">p:77 ch:2 &gt; +</div>
<div class="line"></div>
<div class="line">p:67 ch:0 &gt;</div>
<div class="line">p:71 ch:1 &gt;</div>
<div class="line">p:74 ch:2 &gt; +</div>
<div class="line"></div>
<div class="line">p:67 ch:0 &gt;</div>
<div class="line">p:72 ch:1 &gt;</div>
<div class="line">p:76 ch:2 &gt; +</div>
</div><!-- fragment --><p> <br/>
<br/>
</p>
<p><b><a class="el" href="class_m_c_harmony_pattern.html" title="Represents a harmony pattern, which consist of a list of chords placed on time positions. ">MCHarmonyPattern</a></b><br/>
</p>
<p>First of all, let's talk about the definition string: in order to reference chord patterns from the scripts, you will need to have assigned an unique ID number to each chord pattern you want to have at your disposal. This can be done by writing the definition string. To know its structure and be able to customize it, you can take a look to the default definition placed both in the "scripts" directory and in the "mchords.cpp" source file: <br/>
</p>
<div class="fragment"><div class="line">;-------------------------------</div>
<div class="line">;</div>
<div class="line">; Chords definition file</div>
<div class="line">;</div>
<div class="line">;-------------------------------</div>
<div class="line"></div>
<div class="line">0: 0,4,7           ; M</div>
<div class="line">1: 0,4,7,9         ; M6</div>
<div class="line">2: 0,4,7,11        ; M7</div>
<div class="line">3: 0,4,8           ; Maug5</div>
<div class="line"></div>
<div class="line">4: 0,3,7           ; m</div>
<div class="line">5: 0,3,7,10        ; m7</div>
<div class="line">6: 0,3,6,10        ; m7b5</div>
<div class="line">7: 0,3,7,9         ; m6</div>
<div class="line">8: 0,3,7,11        ; mM7</div>
<div class="line"></div>
<div class="line">9: 0,4,7,10        ; 7</div>
<div class="line">10: 0,4,7,10,14    ; 9</div>
<div class="line">11: 0,4,7,10,13    ; 7m9</div>
<div class="line"></div>
<div class="line">12: 0,3,6          ; dis</div>
<div class="line">13: 0,3,6,9        ; dis7</div>
<div class="line"></div>
<div class="line">14: 0,5,7          ; sus4</div>
<div class="line">15: 0,5,7,10       ; 7sus4</div>
<div class="line"></div>
<div class="line">16: 0,4,6,10       ; 7b5</div>
<div class="line">17: 0,4,8,10       ; 7aug5</div>
</div><!-- fragment --><p><br/>
 Once you have either built your own definition string or decided to use the one that comes by default, then you can write the scripts based on it. The commands referred to the time position are the same that you already know. The rest of the commands are:</p>
<div align="center"> <table  border="1" cellpadding="10">
<tr>
<th>Command </th><th>Description </th><th>Value range  </th></tr>
<tr>
<td>root:&lt;val&gt; </td><td>Root note </td><td>0-11  </td></tr>
<tr>
<td>chord:&lt;val&gt; </td><td>Chord pattern's ID number </td><td>0-...  </td></tr>
<tr>
<td>bass:&lt;val&gt; </td><td>Bass note (only if different than root) </td><td>0-11  </td></tr>
<tr>
<td>tensions:&lt;val,...&gt; </td><td>List of tensions, separated by commas </td><td>0-...  </td></tr>
<tr>
<td>&gt; </td><td>Insert entry </td><td>&mdash;  </td></tr>
</table>
</div><p><br/>
 Example:</p>
<div class="fragment"><div class="line">[m:1]</div>
<div class="line">root:5  chord:9 tensions:14,21 &gt;</div>
<div class="line"></div>
<div class="line">[m:2]</div>
<div class="line">root:10 chord:9 tensions:14,21 &gt;</div>
<div class="line"></div>
<div class="line">[m:3]</div>
<div class="line">root:5  chord:9 tensions:14,21 &gt;</div>
<div class="line"></div>
<div class="line">[m:5]</div>
<div class="line">root:10 chord:9 tensions:14,21 &gt;</div>
<div class="line"></div>
<div class="line">[m:7]</div>
<div class="line">root:5  chord:9 tensions:14,21 &gt;</div>
<div class="line"></div>
<div class="line">[m:9]</div>
<div class="line">root:7  chord:5 &gt;</div>
<div class="line"></div>
<div class="line">[m:10]</div>
<div class="line">root:0  chord:9 tensions:14,21 &gt;</div>
<div class="line"></div>
<div class="line">[m:11]</div>
<div class="line">root:5  chord:9 tensions:14,21 &gt;</div>
<div class="line"></div>
<div class="line">[m:12]</div>
<div class="line">root:7  chord:5 &gt;</div>
<div class="line">[b:3]</div>
<div class="line">root:0  chord:9 tensions:15 &gt;</div>
</div><!-- fragment --><p><br/>
<b><a class="el" href="class_m_c_scale_pattern.html" title="Represents a scale pattern, which consist of a list of scales placed on time positions. ">MCScalePattern</a></b><br/>
</p>
<p>The definition string works in the same way than we have already seen with the harmony pattern. In this case the default definition is placed both in the "scripts" directory and in the "mscales.cpp" source file: <br/>
</p>
<div class="fragment"><div class="line">;-------------------------------</div>
<div class="line">;</div>
<div class="line">; Scales definition file</div>
<div class="line">;</div>
<div class="line">;-------------------------------</div>
<div class="line"></div>
<div class="line">0: 0,2,4,5,7,9,11              ; Major</div>
<div class="line">1: 0,2,3,5,7,8,10              ; Minor</div>
<div class="line">2: 0,2,3,5,7,8,11              ; Minor Harmonic</div>
<div class="line">3: 0,2,3,5,7,9,11              ; Minor Melodic</div>
<div class="line">4: 0,2,4,5,7,8,10              ; Major-Minor</div>
<div class="line"></div>
<div class="line">5: 0,2,3,5,7,9,10              ; Dorian</div>
<div class="line">6: 0,1,3,5,7,8,10              ; Phrygian</div>
<div class="line">7: 0,2,4,6,7,9,11              ; Lydian</div>
<div class="line">8: 0,2,4,5,7,9,10              ; Mixolydian</div>
<div class="line">9: 0,1,3,5,6,8,10              ; Locrian</div>
<div class="line"></div>
<div class="line">10: 0,2,4,6,7,9,10             ; Acoustic</div>
<div class="line">11: 0,1,3,4,6,8,10             ; Altered</div>
<div class="line"></div>
<div class="line">12: 0,2,4,7,9                  ; Pentatonic Major</div>
<div class="line">13: 0,3,5,7,10                 ; Pentatonic Minor</div>
<div class="line">14: 0,3,5,6,7,10               ; Blues</div>
<div class="line">15: 0,3,5,6,7,9,10             ; Blues + Sixth</div>
<div class="line"></div>
<div class="line">16: 0,1,4,5,7,8,10             ; Gypsy</div>
<div class="line">17: 0,1,4,5,7,8,11             ; Double Harmonic</div>
<div class="line"></div>
<div class="line">18: 0,2,4,6,8,10               ; Whole Tone</div>
<div class="line">19: 0,2,3,5,6,8,9,11           ; Octatonic (H-W)</div>
<div class="line">20: 0,1,3,4,6,7,9,10           ; Octatonic (W-H)</div>
<div class="line">21: 0,1,2,3,4,5,6,7,8,9,10,11  ; Chromatic</div>
</div><!-- fragment --><p><br/>
 The time position commands are also the same, whereas the specific commands work as follows:</p>
<div align="center"> <table  border="1" cellpadding="10">
<tr>
<th>Command </th><th>Description </th><th>Value range  </th></tr>
<tr>
<td>root:&lt;val&gt; </td><td>Root note </td><td>0-11  </td></tr>
<tr>
<td>scale:&lt;val&gt; </td><td>Scale pattern's ID number </td><td>0-...  </td></tr>
<tr>
<td>&gt; </td><td>Insert entry </td><td>&mdash;  </td></tr>
</table>
</div><p><br/>
 Example:</p>
<div class="fragment"><div class="line">[m:1]</div>
<div class="line">root:10 scale:8 &gt;</div>
<div class="line"></div>
<div class="line">[m:5]</div>
<div class="line">root:3  scale:8 &gt;</div>
<div class="line"></div>
<div class="line">[m:7]</div>
<div class="line">root:10 scale:8 &gt;</div>
<div class="line"></div>
<div class="line">[m:9]</div>
<div class="line">root:5  scale:8 &gt;</div>
<div class="line"></div>
<div class="line">[m:10]</div>
<div class="line">root:3  scale:8 &gt;</div>
<div class="line"></div>
<div class="line">[m:11]</div>
<div class="line">root:8  scale:10 &gt;</div>
</div><!-- fragment --><p><br/>
<b><a class="el" href="class_m_c_song_structure.html" title="Definition of the structure of a song, which consists of a list of sections. Tempo changes...">MCSongStructure</a></b><br/>
</p>
<p>The song structure scripts don't use a time position cursor, so there are no square-brackets commands. When a new value is assigned to the tempo, the target tempo receive the same value unless you specify another value for it, so you will only have to worry about the target tempo if you want to program an accelerando or ritardando. <br/>
</p>
<p>To write song structure scripts you have the following commands at your disposal: <br/>
</p>
<div align="center"> <table  border="1" cellpadding="10">
<tr>
<th>Command </th><th>Description </th><th>Value range  </th></tr>
<tr>
<td>bpm:&lt;val&gt; </td><td>Beats per measure </td><td>1-...  </td></tr>
<tr>
<td>from:&lt;val&gt; </td><td>First measure of the section </td><td>1-...  </td></tr>
<tr>
<td>to:&lt;val&gt; </td><td>Last measure of the section </td><td>1-...  </td></tr>
<tr>
<td>tempo:&lt;val&gt; </td><td>Tempo </td><td>1-...  </td></tr>
<tr>
<td>target:&lt;val&gt; </td><td>Target tempo (accelerandos, ritardandos) </td><td>1-...  </td></tr>
<tr>
<td>&gt; </td><td>Insert entry </td><td>&mdash;  </td></tr>
</table>
</div><p><br/>
 Example:</p>
<div class="fragment"><div class="line">bpm:4</div>
<div class="line">from:1 to:8 tempo:132 &gt;</div>
<div class="line">from:9 to:12 tempo:180 &gt;</div>
<div class="line"></div>
<div class="line">bpm:3</div>
<div class="line">from:13 to:20 tempo:120 &gt;</div>
<div class="line">from:21 to:24 tempo:120 target:60 &gt;    ; ritardando (120 -&gt; 60)</div>
</div><!-- fragment --><p> <br/>
<br/>
</p>
<h1><a class="anchor" id="pitchvalues"></a>
Pitch values</h1>
<p>As we have already seen, in a <a class="el" href="struct_m_s_note.html" title="Definition of a note to be played. ">MSNote</a> structure the pitch is the note's MIDI pitch value. A MIDI pitch can take values from 0 ("note off" in MIDI, "rest" in Modus) to 127, since it is a 7-bit value, whereas a <a class="el" href="struct_m_s_note.html" title="Definition of a note to be played. ">MSNote</a> pitch is a 8-bit value, so it can have values up to 255. Thus, pitch values between 128 and 255 will have a special meaning in Modus: some are predefined control values, and the rest are available for you to interpret them in the way you want. <br/>
</p>
<p>The predefined control values are:</p>
<ul>
<li>
<p class="startli">Pitch 128 - Bending. </p>
<ul>
<li>
Channel: channel through which the note to modify is sounding </li>
<li>
Mode: 0 up, 1 down </li>
<li>
Intensity: number of semitones </li>
<li>
MDA: number of cents </li>
<li>
Duration: number of ticks </li>
</ul>
<p class="endli"></p>
</li>
<li>
<p class="startli">Pitch 129 - Damper. </p>
<ul>
<li>
Intensity: 0 off, 1 on </li>
</ul>
<p class="endli"></p>
</li>
<li>
<p class="startli">Pitch 130 - Intensity change. </p>
<ul>
<li>
Channel: channel through which the note to modify is sounding </li>
<li>
Intensity: new intensity value </li>
<li>
Duration: number of ticks </li>
</ul>
<p class="endli"></p>
</li>
<li>
<p class="startli">Pitch 131 - Set release time. </p>
<ul>
<li>
Intensity: from 1 (slow) to 255 (fast). The default value is 100 </li>
</ul>
<p class="endli"></p>
</li>
<li>
<p class="startli">Pitch 132 - Set vibrato. </p>
<ul>
<li>
Channel: channel through which the note to modify is sounding </li>
<li>
Intensity: number of cents </li>
<li>
Duration: cycle length in number of ticks </li>
</ul>
<p class="endli"></p>
</li>
</ul>
<p><br/>
</p>
<h1><a class="anchor" id="callbacks"></a>
Callbacks</h1>
<p>Besides the already known timer's tick callback, you can ask Modus to let you know when some events occur, so you don't need to do a continuous polling to check them:</p>
<p><br/>
<b><a class="el" href="class_m_c_timer.html" title="Timer object that provides a periodic signal to make it possible to play music according to a particu...">MCTimer</a></b><br/>
</p>
<table  border="1" cellpadding="10">
<tr>
<th>Callback </th><td>Tick  </td></tr>
<tr>
<th>Called when </th><td>A new tick has come  </td></tr>
<tr>
<th>Information </th><td>Current time position  </td></tr>
<tr>
<th>Method to register </th><td><em>setCallbackTick()</em>  </td></tr>
</table>
<p><br/>
</p>
<table  border="1" cellpadding="10">
<tr>
<th>Callback </th><td>Section  </td></tr>
<tr>
<th>Called when </th><td>A new section has come (it must have been defined in a song structure object)  </td></tr>
<tr>
<th>Information </th><td>Number of the current section  </td></tr>
<tr>
<th>Method to register </th><td><em>setCallbackSection()</em>  </td></tr>
</table>
<p><br/>
</p>
<table  border="1" cellpadding="10">
<tr>
<th>Callback </th><td>End  </td></tr>
<tr>
<th>Called when </th><td>The song has ended (all the song's sections must have been defined in a song structure object)  </td></tr>
<tr>
<th>Information </th><td>-  </td></tr>
<tr>
<th>Method to register </th><td><em>setCallbackEnd()</em>  </td></tr>
</table>
<p><br/>
</p>
<p><br/>
<b><a class="el" href="class_m_c_instrument.html" title="Represents an entity that is able to play notes. ">MCInstrument</a></b><br/>
</p>
<table  border="1" cellpadding="10">
<tr>
<th>Callback </th><td>Play  </td></tr>
<tr>
<th>Called when </th><td>A note is being played  </td></tr>
<tr>
<th>Information </th><td>Note that is being played  </td></tr>
<tr>
<th>Method to register </th><td><em>setCallbackPlay()</em>  </td></tr>
</table>
<p><br/>
</p>
<table  border="1" cellpadding="10">
<tr>
<th>Callback </th><td>Next note  </td></tr>
<tr>
<th>Called when </th><td>A note is being played and there are more notes in the score  </td></tr>
<tr>
<th>Information </th><td>Note that comes after the current note or chord, current time moment and next note's time moment<br/>
 (in case several notes are coming together this method will be called once for each note)  </td></tr>
<tr>
<th>Method to register </th><td><em>setCallbackNextNote()</em>  </td></tr>
</table>
<p><br/>
</p>
<table  border="1" cellpadding="10">
<tr>
<th>Callback </th><td>Release  </td></tr>
<tr>
<th>Called when </th><td>A note is being released  </td></tr>
<tr>
<th>Information </th><td>Note that is being released  </td></tr>
<tr>
<th>Method to register </th><td><em>setCallbackRelease()</em>  </td></tr>
</table>
<p><br/>
</p>
<table  border="1" cellpadding="10">
<tr>
<th>Callback </th><td>Bending  </td></tr>
<tr>
<th>Called when </th><td>A note is being bended  </td></tr>
<tr>
<th>Information </th><td>Note and frequency variation in cents  </td></tr>
<tr>
<th>Method to register </th><td><em>setCallbackBending()</em>  </td></tr>
</table>
<p><br/>
</p>
<table  border="1" cellpadding="10">
<tr>
<th>Callback </th><td>Damper  </td></tr>
<tr>
<th>Called when </th><td>The state of the damper pedal has changed  </td></tr>
<tr>
<th>Information </th><td>Current state of the damper pedal  </td></tr>
<tr>
<th>Method to register </th><td><em>setCallbackDamper()</em>  </td></tr>
</table>
<p><br/>
</p>
<table  border="1" cellpadding="10">
<tr>
<th>Callback </th><td>Intensity  </td></tr>
<tr>
<th>Called when </th><td>A note's intensity is being changed  </td></tr>
<tr>
<th>Information </th><td>Note and current intensity  </td></tr>
<tr>
<th>Method to register </th><td><em>setCallbackIntensity()</em>  </td></tr>
</table>
<p><br/>
</p>
<h1><a class="anchor" id="representing"></a>
Representing musical performances</h1>
<p>These callback services you have just known are a very good way to represent visually musical performances. A first approach could be register play and release callback functions and do something on the screen each time one of these events happens. <br/>
</p>
<p>However, this solution is not valid if you want to include animations, because in that case you will need to know which note is the next one and when it must be played before it comes (for example, to take the player's arm to the correct place before playing the note). For this purpose the instrument object's "Next note" service may be particularly useful: it calls your previously defined function each time a note or chord is played, indicating the current time moment, the time moment in which the next note is going to be played, and which note it is. <br/>
</p>
<p>But if you want to go one step further and represent a performance accurately, besides the animations you should take into account that into each note (<a class="el" href="struct_m_s_note.html" title="Definition of a note to be played. ">MSNote</a> structure) there are three metadata fields (MDA, MDB, MDC) at your disposal, which can store <em>unsigned char</em> values (from 0 to 255). These values will be typically utilized for representing technical aspects of the performance, for example:</p>
<ul>
<li>
Piano: hand (left or right), finger </li>
<li>
Guitar: string, fret, right hand technique </li>
<li>
Wind instrument: positioning, state of the holes/keys/valves </li>
<li>
Percussion: strike's point </li>
</ul>
<p>Lastly, you may also want to include other things such as musician's movements or something like that. For this purposal, the best way would be to use pitch values out of the instrument's range to denote additional things that you can define and then interpret in the way you want. <br/>
</p>
<p>In summary: as you can see, with Modus you have a complete platform to represent or simulate musical performances. All you have to do is fill your scores with the appropriate values along with a good graphic work, and you will be able to achieve excelent results. In the following table you can see all the possibilities together: <br/>
</p>
<div align="center"> <table  border="1" cellpadding="10">
<tr>
<th>If you want to represent... </th><th>...then you'll need  </th></tr>
<tr>
<td>Schematic performance </td><td>Play callback<br/>
Release callback<br/>
[Damper callback]<br/>
[Bending callback]<br/>
[Intensity callback]  </td></tr>
<tr>
<td>Animations </td><td>Next note callback  </td></tr>
<tr>
<td>Technical details </td><td>Metadata fields  </td></tr>
<tr>
<td>Musician's movements, gestures, etc. </td><td>Pitches out of range  </td></tr>
</table>
</div><p> <br/>
</p>
<h1><a class="anchor" id="tipsandtricks"></a>
Tips and tricks</h1>
<ul>
<li>
<p class="startli">Loop management. This can be done easily inside the timer's tick callback function, by checking the current time position and displacing the score each time a multiple of the length of the loop -given in number of measures- is reached:</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> CallbackTick(<span class="keyword">const</span> <a class="code" href="struct_m_s_time_position.html" title="Defines a time position in the music (measure, beat and tick) ">MSTimePosition</a>&amp; mPos, <span class="keywordtype">void</span>* pData)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// loop management</span></div>
<div class="line">    <span class="keywordflow">if</span>(mPos.Measure % LOOP == 1 &amp;&amp; mPos.Measure &gt; LOOP &amp;&amp; mPos.Beat == 1 &amp;&amp; mPos.Tick == 0)</div>
<div class="line">    {   </div>
<div class="line">        mScore-&gt;displace(LOOP);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="comment">// update instruments</span></div>
<div class="line">    ...</div>
<div class="line">}</div>
</div><!-- fragment --><p>The loop management code must be always placed before the instrument's update call. Otherwise, the note(s) on the measure 1, beat 1 and tick 0 in the score wouldn't be played. </p>
<p><br/>
</p>
<p class="endli"></p>
</li>
<li>
<p class="startli">Score on countoff. Notes cannot be placed into a score to be played before the measure 0, but that can be done by following this simple trick (remember that you can make displacements with negative numbers):</p>
<div class="fragment"><div class="line"><a class="code" href="class_m_c_score.html" title="Represents a score, which consist of a list of notes placed on time positions. ">MCScore</a> mScore;</div>
<div class="line">mScore.<a class="code" href="class_m_c_score.html#a9c0939510b16c88fab9fe3c6af76a3d8" title="Load script with information to fill entries from a file. ">loadScriptFromFile</a>(<span class="stringliteral">&quot;myscore.txt&quot;</span>);</div>
<div class="line">mScore.<a class="code" href="class_m_c_list_music.html#aa6b7f52ba75b84136c2894640b2825a9" title="Displace all the entries by the specified number of measures. ">displace</a>(-2);</div>
</div><!-- fragment --> <p><br/>
</p>
<p class="endli"></p>
</li>
<li>
<p class="startli">"Repeat signs" in a score from code. If you want a certain section to be repeated several times, you can use a score object to store that section and then add it to the final score as many times as you need:</p>
<div class="fragment"><div class="line"><a class="code" href="class_m_c_score.html" title="Represents a score, which consist of a list of notes placed on time positions. ">MCScore</a> mSection;</div>
<div class="line"><a class="code" href="class_m_c_score.html" title="Represents a score, which consist of a list of notes placed on time positions. ">MCScore</a> mFinalScore;</div>
<div class="line"></div>
<div class="line"><span class="comment">// fill the section with notes</span></div>
<div class="line">...</div>
<div class="line"></div>
<div class="line">const <span class="keywordtype">int</span> iNumberOfRepetitions = 4;</div>
<div class="line"><span class="keyword">const</span> <span class="keywordtype">int</span> iSectionLengthInMeasures = 16;</div>
<div class="line"></div>
<div class="line"><span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; iNumberOfRepetitions; i++)</div>
<div class="line">{</div>
<div class="line">    mFinalScore.<a class="code" href="class_m_c_score.html#a0f5341188804601f9a3ae8429edfa358" title="Merge the current entries with another score&#39;s entries. ">addScore</a>(mSection);</div>
<div class="line">    mSection.<a class="code" href="class_m_c_list_music.html#aa6b7f52ba75b84136c2894640b2825a9" title="Displace all the entries by the specified number of measures. ">displace</a>(iSectionLengthInMeasures);</div>
<div class="line">}</div>
</div><!-- fragment --> <p><br/>
</p>
<p class="endli"></p>
</li>
<li>
<p class="startli">Separated hands. Don't forget the possibility to write several scripts and combine them to be played by the same instrument when the music to write is too complex. For example, in a piano piece you could write a script for each hand and then put it all together:</p>
<div class="fragment"><div class="line"><a class="code" href="class_m_c_score.html" title="Represents a score, which consist of a list of notes placed on time positions. ">MCScore</a> mScoreLeftHand;</div>
<div class="line">mScoreLeftHand.<a class="code" href="class_m_c_score.html#a9c0939510b16c88fab9fe3c6af76a3d8" title="Load script with information to fill entries from a file. ">loadScriptFromFile</a>(<span class="stringliteral">&quot;score.lefthand.txt&quot;</span>);</div>
<div class="line"></div>
<div class="line"><a class="code" href="class_m_c_score.html" title="Represents a score, which consist of a list of notes placed on time positions. ">MCScore</a> mScorePiano;</div>
<div class="line">mScorePiano.<a class="code" href="class_m_c_score.html#a9c0939510b16c88fab9fe3c6af76a3d8" title="Load script with information to fill entries from a file. ">loadScriptFromFile</a>(<span class="stringliteral">&quot;score.righthand.txt&quot;</span>);</div>
<div class="line">mScorePiano.<a class="code" href="class_m_c_score.html#a0f5341188804601f9a3ae8429edfa358" title="Merge the current entries with another score&#39;s entries. ">addScore</a>(mScoreLeftHand);</div>
<div class="line"></div>
<div class="line">mPiano-&gt;setScore(&amp;mScorePiano);</div>
</div><!-- fragment --> <p><br/>
</p>
<p class="endli"></p>
</li>
<li>
<p class="startli">Sforzando-piano. For wind instruments it can be achieved by playing a note with a high intensity and then setting a quick change of intensity like this:</p>
<div class="fragment"><div class="line"><a class="code" href="struct_m_s_note.html" title="Definition of a note to be played. ">MSNote</a> mNote;</div>
<div class="line">mNote.Pitch = 48;</div>
<div class="line">mNote.Intensity = 127;</div>
<div class="line">mNote.Channel = 0;</div>
<div class="line">mNote.Duration = 0;</div>
<div class="line"></div>
<div class="line">mTenorSax-&gt;playNote(mNote);</div>
<div class="line">mTenorSax-&gt;changeIntensity(0, 48, 4);</div>
</div><!-- fragment --> <p><br/>
</p>
<p class="endli"></p>
</li>
<li>
<p class="startli">Metronome. It's very easy to create a simple metronome in case you need a tempo reference. One way to do it is playing a note inside the timer's tick callback function, like this:</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> CallbackTick(<span class="keyword">const</span> <a class="code" href="struct_m_s_time_position.html" title="Defines a time position in the music (measure, beat and tick) ">MSTimePosition</a>&amp; mTimePosition, <span class="keywordtype">void</span>* pData)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// metronome</span></div>
<div class="line">    <span class="keywordflow">if</span>(mTimePosition.Tick == 0)</div>
<div class="line">    {</div>
<div class="line">        <a class="code" href="struct_m_s_note.html" title="Definition of a note to be played. ">MSNote</a> mClick;</div>
<div class="line">        mClick.Pitch = (mTimePosition.Beat == 1)? 81: 69;</div>
<div class="line">        mClick.Intensity = 127;</div>
<div class="line">        mClick.Duration = 4;</div>
<div class="line">        mPiano-&gt;playNote(mClick);</div>
<div class="line">    }</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// update instruments</span></div>
<div class="line">    ...</div>
<div class="line">}</div>
</div><!-- fragment --><p>Remember that the instrument's update must be always done after the rest of the code in the timer tick callback function! <br/>
 </p>
<p><br/>
</p>
<p class="endli"></p>
</li>
<li>
<p class="startli">Improviser. Try not to generate music for too many measures when you use the improviser, since the <em>improvise()</em> method could need much CPU usage and it might appear a small pause in the music each time you call it. If you need to generate a large number of measures, you can divide them into smaller pieces so the improviser does not take so long -for example, for 64 measures you could call the improviser four times with 16, or even eight times with 8-. The <em>setPreviousNote()</em> and <em>setIntensity()</em> methods are provided for you to be able to ensure the continuity of the improvisation. </p>
<p class="endli"></p>
</li>
</ul>
<p><br/>
<br/>
</p>
<div align="center"> Copyright (c) 2012-2013 Arturo Cepeda P&eacute;rez </div> </div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Sun Aug 18 2013 17:46:07 for Modus by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.4 </li>
  </ul>
</div>
</body>
</html>
